<h1><%= @portfolio.name %></h1>
<h2><%= @portfolio.user.email %></h2>

<%= form_for [@portfolio, @coin_portfolio] do |f| %>
  <%= f.fields_for :coin do |coin_fields| %>
    <%= coin_fields.label :name %>
    <%= coin_fields.text_field :name, list: 'coin-name' %>
    <p class='error'><%= show_errors(@coin_portfolio, :coin) %></p>
    <datalist id="coin-name">
      <% Coin.new_list(@portfolio).each do |coin| %>
        <option value="<%= coin.name %>"></option>
      <% end %>
    </datalist>
  <% end %>
  <%= f.label :quantity %>
  <%= f.number_field :quantity %>
  <p class='error'><%= show_errors(@coin_portfolio, :quantity) %></p>
  <%= f.submit 'Add coin' %>
<% end %>

<ul>
  <% @portfolio.coins.each do |coin| %>
    <li><%= coin.name %></li>
    <li><%= coin.quantity(@portfolio) %></li>
    <li><%= coin.price_usd %></li>
    <li><%= coin.market_cap_usd %></li>
    <li><%= coin.percentage_change_24h %></li>
    <li><%= link_to 'Edit coin', edit_coin_portfolio_path(coin.find_coin_portfolio(@portfolio)) %></li>
  <% end %>
</ul>
<p><%= link_to 'See all portfolios', portfolios_path %></p>